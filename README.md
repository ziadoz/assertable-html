![Assertable HTML](art/logo.png)

Assertable HTML is an elegantly designed PHPUnit library that makes performing assertions on HTML responses from PHP and Laravel applications quick and enjoyable.

Here's a quick example:

```php
use Ziadoz\AssertableHtml\Dom\AssertableDocument;
use Ziadoz\AssertableHtml\Dom\AssertableElement;

// Make the response HTML an assertable document...
$html = AssertableDocument::createFromString(<<<HTML
    <h1>Dashboard</h1>
    <nav>
        <a href="/profile" class="nav-link">Profile</a>
        <a href="/logout" class="nav-link">Logout</a>
    </nav>
    <div id="content">
        <h2 class="subheading welcome">Welcome, Archie</h2>
        <!-- ... -->
    </div>
    <div id="sidebar">
        <h3 class="subheading">Actions</h3>
        <!-- ... -->
    </div>
HTML, LIBXML_NOERROR);


// Start performing assertions...
$html->querySelector('h1')
    ->assertTextEquals('Dashboard');

$html->with('nav', function (AssertableElement $nav) {
    $links = $nav->querySelectorAll('a')
        ->assertCount(2)
        ->assertAll(function (AssertableElement $a) {
            $a->classes->contains('nav-link');
        });

    $links[0]->assertAttributeEquals('href', '/profile')
        ->assertTextEquals('Profile');
        
    $links[1]->assertAttributeEquals('href', '/logout')
        ->assertTextEquals('Settings');
        
    // More assertions within <nav>...
});

$html->with('#content', function (AssertableElement $div) {
    $div->with('h2', function (AssertableElement $h2) {   
        $h2->assertClassContainsAll(['subheading', 'welcome'])
            ->assertTextContains('Welcome');
    });
        
    $div->elsewhere('#sidebar h3', function (AssertableElement $h3) {
        $h3->assertClassContainsAll(['subheading'])
            ->assertTextContains('Actions');
    });
    
    // More assertions within <div id="content">...
});

```

It's cumbersome to test HTML generated by template engines such as Blade and Twig. Assertable HTML parses your web application responses as proper HTML, and provides a fluent interface to quickly write test assertions against it. 

The fluent interface API is similar, but not identical, to PHP 8.4's new HTML document parsing API, however, it's significantly simpler and stripped back to only the bits required for HTML testing.

## üì¶ Requirements

- PHP 8.4
- Composer

## üñ• Installation

You can install the package using Composer:

```bash
composer install ziadoz/assertable-html
```

If you're using Laravel, Assertable HTML will be automatically discovered. You can still register it manually if needed:

```php
<?php

namespace App\Providers;

use Illuminate\Support\ServiceProvider;
use Ziadoz\AssertableHtml\AssertableHtmlServiceProvider;

class AppServiceProvider extends ServiceProvider
{
    public function register(): void
    {
        $this->app->register(AssertableHtmlServiceProvider::class);
    }
}
```

## üî® Usage

### Basics

### Assertions

### Advanced Assertions

## üëè Thanks

This package wouldn't be possible without the following people and projects:

- Rachel ‚ù§Ô∏è, Archie üê∂ and Rigby üê∂
- Niels Dossche (PHP 8.4 HTML parsing API author)
- [Lexbor](https://github.com/lexbor/lexbor) (the library that powers PHP 8.4's HTML parsing API)
